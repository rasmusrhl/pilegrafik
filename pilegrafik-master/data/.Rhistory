home_library         <- "C:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/"               # bibliotek hvor scriptet afvikles fra
measurement_year     <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/data/"                                  # bibliotek med data
disease_text         <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/disease text/" # bibliotek med sygdomstekster
setwd( home_library )
unlink( x = "ny mappe", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/danish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/english_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/swedish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/norwegian_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/finnish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/icelandic_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
source( file = "english filenames.R")
# rstudio plots output
rstudio_output <- c(paste0(  "male1year",  "-",  1:56, ".png" ) ,
paste0(  "female1year",  "-",  1:56, ".png" ),
paste0(  "male5year",  "-",  1:56, ".png" ) ,
paste0(  "female5year",  "-",  1:56, ".png" ) )
rename_dataframe <- data.frame( english_filenames, rstudio_output, stringsAsFactors = FALSE )
# English -----------------------------------------------------------------
# english
setwd( home_library )
sprog_kode <- 1  # english
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/english.docx", clean = FALSE   )
setwd( paste0(home_library,  "output/english_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Danish ------------------------------------------------------------------
setwd( home_library)
sprog_kode <- 2  # danish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "danish.docx",  clean = FALSE    )
setwd( paste0(home_library,  "/danish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Finnish -----------------------------------------------------------------
setwd( home_library)
sprog_kode <- 3  # finnish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/finnish.docx",  clean = FALSE   )
setwd( paste0(home_library,  "output/finnish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Icelandic ---------------------------------------------------------------
setwd( home_library)
sprog_kode <- 4  # icelandic
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/icelandic.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/icelandic_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Norwegian ---------------------------------------------------------------
setwd( home_library)
sprog_kode <- 5  # norwegian
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/norwegian.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/norwegian_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Swedish -----------------------------------------------------------------
setwd( home_library)
sprog_kode <- 6  # swedish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/swedish.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/swedish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Copy to output folder ---------------------------------------
setwd( home_library)
unlink( x = "plot output", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
dir.create( "plot output" )
setwd( paste0( home_library, "plot output/"))
dir.create( "swedish" )
dir.create( "danish" )
dir.create( "english" )
dir.create( "finnish" )
dir.create( "norwegian" )
dir.create( "icelandic" )
setwd( home_library)
file.copy( from = list.files("output/swedish_files/figure-docx/", full.names = TRUE), to = "plot output/swedish/" )
file.copy( from = list.files("output/danish_files/figure-docx/",  full.names = TRUE), to = "plot output/danish/")
file.copy( from = list.files("output/english_files/figure-docx/", full.names = TRUE), to = "plot output/english/")
file.copy( from = list.files("output/finnish_files/figure-docx/", full.names = TRUE), to = "plot output/finnish/")
file.copy( from = list.files("output/norwegian_files/figure-docx/", full.names = TRUE), to = "plot output/norwegian/")
file.copy( from = list.files("output/icelandic_files/figure-docx/", full.names = TRUE), to = "plot output/icelandic/")
# Copy/rename to Jacques folder ---------------------------------------
# copy
setwd( home_library)
unlink( x = "Jacques plots", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
dir.create( "Jacques plots" )
setwd( paste0( home_library, "Jacques plots/") )
dir.create( "swedish" )
dir.create( "danish" )
dir.create( "english" )
dir.create( "finnish" )
dir.create( "norwegian" )
dir.create( "icelandic" )
setwd( home_library )
file.copy( from = list.files("output/swedish_files/figure-docx/", full.names = TRUE), to = "Jacques plots/swedish" )
file.copy( from = list.files("output/danish_files/figure-docx/",  full.names = TRUE), to = "Jacques plots/danish")
file.copy( from = list.files("output/english_files/figure-docx/", full.names = TRUE), to = "Jacques plots/english")
file.copy( from = list.files("output/finnish_files/figure-docx/", full.names = TRUE), to = "Jacques plots/finnish")
file.copy( from = list.files("output/norwegian_files/figure-docx/", full.names = TRUE), to = "Jacques plots/norwegian")
file.copy( from = list.files("output/icelandic_files/figure-docx/", full.names = TRUE), to = "Jacques plots/icelandic")
setwd( home_library)
source(  file = "Jacques plotnames.R")
# danish
setwd(  paste0( home_library, "Jacques plots/danish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$danish_name_jac)
# english
setwd(  paste0( home_library, "Jacques plots/english/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$english_name_jac)
# finnish
setwd(  paste0( home_library, "Jacques plots/finnish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$finnish_name_jac )
# Icelandic
setwd(  paste0( home_library, "Jacques plots/icelandic/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$icelandic_name_jac)
# Norwegian
setwd(  paste0( home_library, "Jacques plots/norwegian/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$norwegian_name_jac  )
# Swedish
setwd(  paste0( home_library, "Jacques plots/swedish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$swedish_name_jac)
# delete 888 plots --------------------------------------------------------
# The plots called 888 (bassocellular carcinomas) are deleted.
setwd(  paste0( home_library, "Jacques plots") )
plots_888 <- list.files( pattern = "888", recursive = TRUE )
plots_888_full_path <- paste0( home_library, "/Jacques plots", "/",  plots_888 )
file.remove(  plots_888_full_path )
stop_time <- Sys.time()
compute_time <- stop_time - start_time
compute_time
# Beskrivelse af scriptet:
# dette skript kÃ¸rer skriptet "pilegrafik 6 sprog", seks gange, Ã©n gang for hvert sprog.
# "pilegrafik 6 sprog" kÃ¸rer ogsÃ¥ andre skripts.
# Af historiske grund sÃ¥ laver dette skript et 5 word dokumenter et for hvert af sprogene
# Svensk, Dansk, Engelsk, Finsk, Norsk og Islandsk. Til hvert document hÃ¸rer der en mappe
# som indeholder png-filerne til hvert dokument. Det er disse filer vi er interesserede i.
#   Knitr dÃ¸ber filerne som male1year-1, male1year-2 etc. Dette skript omdÃ¸ber filerne til engelske
# navne.
#   Derefter kopierer den filerne til en anden mappe som hedder plot output, som indeholder en e
# mappe for hvert sprog.
#   Derefter kopieres filerne til en mappe som hedder jacques plots, hvorefter disse filer omdÃ¸bes
# til et navnesystem som Jacques i frankrig har Ã¸nsket.
# Filerne omdÃ¸bes ved at have en liste med de navne som knitr laver, sammen med en liste over de nye navne,
# og sÃ¥ file.rename( from =, to). Oprindeligt havde jeg forsÃ¸gt at anvende filens oprettelsesdato, via file.info og ctime
# men ctime (creation time) blev forkert for filer der tog lÃ¦ngere tid at lave. sÃ¥ hvis fil nummer 10 lang tid at lave, sÃ¥ kom
# den bagefter i kÃ¸en sÃ¥ at sige.
# Til sidst i scriptet bliver filer som har en endelse pÃ¥ 888 slettet. De laves af scriptet, automatisk, og det er lettere at slette dem
# til sidst, end at Ã¦ndre i scriptet sÃ¥ de slet ikke bliver lavet.
library(knitr)
library(rmarkdown)
library(shape)
library(dplyr)
library(reshape2 )
library(ggplot2)
library(scales)
home_library         <- "C:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/"               # bibliotek hvor scriptet afvikles fra
measurement_year     <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/data/"                                  # bibliotek med data
disease_text         <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/disease text/" # bibliotek med sygdomstekster
setwd( home_library )
unlink( x = "ny mappe", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/danish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/english_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/swedish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/norwegian_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/finnish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/icelandic_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
# english filenames and rstudio filenames are combined (so that I can rename the rstudio filenames to the english filenames, without relying on creationtime which goes wrong)
source( file = "english filenames.R")
# rstudio plots output
rstudio_output <- c(paste0(  "male1year",  "-",  1:56, ".png" ) ,
paste0(  "female1year",  "-",  1:56, ".png" ),
paste0(  "male5year",  "-",  1:56, ".png" ) ,
paste0(  "female5year",  "-",  1:56, ".png" ) )
rename_dataframe <- data.frame( english_filenames, rstudio_output, stringsAsFactors = FALSE )
# English -----------------------------------------------------------------
# english
setwd( home_library )
sprog_kode <- 1  # english
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/english.docx", clean = FALSE   )
setwd( paste0(home_library,  "output/english_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Danish ------------------------------------------------------------------
setwd( home_library)
sprog_kode <- 2  # danish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "danish.docx",  clean = FALSE    )
setwd( paste0(home_library,  "/danish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Finnish -----------------------------------------------------------------
setwd( home_library)
sprog_kode <- 3  # finnish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/finnish.docx",  clean = FALSE   )
setwd( paste0(home_library,  "output/finnish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Icelandic ---------------------------------------------------------------
setwd( home_library)
sprog_kode <- 4  # icelandic
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/icelandic.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/icelandic_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Norwegian ---------------------------------------------------------------
setwd( home_library)
sprog_kode <- 5  # norwegian
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/norwegian.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/norwegian_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Swedish -----------------------------------------------------------------
setwd( home_library)
sprog_kode <- 6  # swedish
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/swedish.docx",  clean = FALSE )
setwd( paste0(home_library,  "output/swedish_files/figure-docx/") )
file.rename( rename_dataframe$rstudio_output ,  rename_dataframe$english_filenames )
gc()
# Copy to output folder ---------------------------------------
setwd( home_library)
unlink( x = "plot output", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
dir.create( "plot output" )
setwd( paste0( home_library, "plot output/"))
dir.create( "swedish" )
dir.create( "danish" )
dir.create( "english" )
dir.create( "finnish" )
dir.create( "norwegian" )
dir.create( "icelandic" )
setwd( home_library)
file.copy( from = list.files("output/swedish_files/figure-docx/", full.names = TRUE), to = "plot output/swedish/" )
file.copy( from = list.files("output/danish_files/figure-docx/",  full.names = TRUE), to = "plot output/danish/")
file.copy( from = list.files("output/english_files/figure-docx/", full.names = TRUE), to = "plot output/english/")
file.copy( from = list.files("output/finnish_files/figure-docx/", full.names = TRUE), to = "plot output/finnish/")
file.copy( from = list.files("output/norwegian_files/figure-docx/", full.names = TRUE), to = "plot output/norwegian/")
file.copy( from = list.files("output/icelandic_files/figure-docx/", full.names = TRUE), to = "plot output/icelandic/")
# Copy/rename to Jacques folder ---------------------------------------
# copy
setwd( home_library)
unlink( x = "Jacques plots", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
dir.create( "Jacques plots" )
setwd( paste0( home_library, "Jacques plots/") )
dir.create( "swedish" )
dir.create( "danish" )
dir.create( "english" )
dir.create( "finnish" )
dir.create( "norwegian" )
dir.create( "icelandic" )
setwd( home_library )
file.copy( from = list.files("output/swedish_files/figure-docx/", full.names = TRUE), to = "Jacques plots/swedish" )
file.copy( from = list.files("output/danish_files/figure-docx/",  full.names = TRUE), to = "Jacques plots/danish")
file.copy( from = list.files("output/english_files/figure-docx/", full.names = TRUE), to = "Jacques plots/english")
file.copy( from = list.files("output/finnish_files/figure-docx/", full.names = TRUE), to = "Jacques plots/finnish")
file.copy( from = list.files("output/norwegian_files/figure-docx/", full.names = TRUE), to = "Jacques plots/norwegian")
file.copy( from = list.files("output/icelandic_files/figure-docx/", full.names = TRUE), to = "Jacques plots/icelandic")
setwd( home_library)
source(  file = "Jacques plotnames.R")
# danish
setwd(  paste0( home_library, "Jacques plots/danish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$danish_name_jac)
# english
setwd(  paste0( home_library, "Jacques plots/english/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$english_name_jac)
# finnish
setwd(  paste0( home_library, "Jacques plots/finnish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$finnish_name_jac )
# Icelandic
setwd(  paste0( home_library, "Jacques plots/icelandic/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$icelandic_name_jac)
# Norwegian
setwd(  paste0( home_library, "Jacques plots/norwegian/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$norwegian_name_jac  )
# Swedish
setwd(  paste0( home_library, "Jacques plots/swedish/") )
file.rename(  from = jacques_names$long_png,  to =  jacques_names$swedish_name_jac)
# delete 888 plots --------------------------------------------------------
# The plots called 888 (bassocellular carcinomas) are deleted.
setwd(  paste0( home_library, "Jacques plots") )
plots_888 <- list.files( pattern = "888", recursive = TRUE )
plots_888_full_path <- paste0( home_library, "/Jacques plots", "/",  plots_888 )
file.remove(  plots_888_full_path )
stop_time <- Sys.time()
compute_time <- stop_time - start_time
compute_time
# Beskrivelse af scriptet:
# dette skript kÃ¸rer skriptet "pilegrafik 6 sprog", seks gange, Ã©n gang for hvert sprog.
# "pilegrafik 6 sprog" kÃ¸rer ogsÃ¥ andre skripts.
# Af historiske grund sÃ¥ laver dette skript et 5 word dokumenter et for hvert af sprogene
# Svensk, Dansk, Engelsk, Finsk, Norsk og Islandsk. Til hvert document hÃ¸rer der en mappe
# som indeholder png-filerne til hvert dokument. Det er disse filer vi er interesserede i.
#   Knitr dÃ¸ber filerne som male1year-1, male1year-2 etc. Dette skript omdÃ¸ber filerne til engelske
# navne.
#   Derefter kopierer den filerne til en anden mappe som hedder plot output, som indeholder en e
# mappe for hvert sprog.
#   Derefter kopieres filerne til en mappe som hedder jacques plots, hvorefter disse filer omdÃ¸bes
# til et navnesystem som Jacques i frankrig har Ã¸nsket.
# Filerne omdÃ¸bes ved at have en liste med de navne som knitr laver, sammen med en liste over de nye navne,
# og sÃ¥ file.rename( from =, to). Oprindeligt havde jeg forsÃ¸gt at anvende filens oprettelsesdato, via file.info og ctime
# men ctime (creation time) blev forkert for filer der tog lÃ¦ngere tid at lave. sÃ¥ hvis fil nummer 10 lang tid at lave, sÃ¥ kom
# den bagefter i kÃ¸en sÃ¥ at sige.
# Til sidst i scriptet bliver filer som har en endelse pÃ¥ 888 slettet. De laves af scriptet, automatisk, og det er lettere at slette dem
# til sidst, end at Ã¦ndre i scriptet sÃ¥ de slet ikke bliver lavet.
install.packates("shape")
install.packages("shape")
library(knitr)
library(rmarkdown)
library(shape)
library(dplyr)
library(reshape2 )
library(ggplot2)
library(scales)
home_library         <- "C:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/"               # bibliotek hvor scriptet afvikles fra
measurement_year     <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/data/"                                  # bibliotek med data
disease_text         <- "c:/Users/rahela/Desktop/pilegrafik-master/pilegrafik-master/disease text/" # bibliotek med sygdomstekster
setwd( home_library )
unlink( x = "ny mappe", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/danish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/english_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/swedish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/norwegian_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/finnish_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
unlink( x = "output/icelandic_files", recursive = TRUE, force = TRUE) # slet evt. tidligere output filer.
source( file = "english filenames.R")
rstudio_output <- c(paste0(  "male1year",  "-",  1:56, ".png" ) ,
paste0(  "female1year",  "-",  1:56, ".png" ),
paste0(  "male5year",  "-",  1:56, ".png" ) ,
paste0(  "female5year",  "-",  1:56, ".png" ) )
rename_dataframe <- data.frame( english_filenames, rstudio_output, stringsAsFactors = FALSE )
# english
setwd( home_library )
sprog_kode <- 1  # english
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/english.docx", clean = FALSE   )
home_library
measurement_year
measurement_year     <- "data/"                                  # bibliotek med data
# english
setwd( home_library )
sprog_kode <- 1  # english
rmarkdown::render( input = "pilegrafik_6_sprog.Rmd", "word_document", output_file = "output/english.docx", clean = FALSE   )
opts_chunk$set(warning=FALSE, echo=FALSE, message = FALSE, fig.width = 6, fig.height = 4.5, dpi = 600, dev = c("png"), cache = FALSE)
setwd( home_library)
base::source( file = "data hentes.R",     encoding = "UTF-8"    )
setwd( home_library)
base::source( file = "function 3 pile.R", encoding = "UTF-8"    )
View(Prostata_1year_male_240)
setwd( paste0( home_library, measurement_year ) )
paste0( home_library, measurement_year )
dk <-    read.csv( file = "DK_RS_file.csv", sep = ";", header = TRUE )
fi <-    read.csv( file = "FI_rs_file.csv", sep = ";", header = TRUE )
no <-    read.csv( file = "NO_rs_file.csv", sep = ";", header = TRUE )
se <-    read.csv( file = "SE_rs_file.csv", sep = ";", header = TRUE )
dk$variable <- "Danmark"
fi$variable <- "Finland"
no$variable <- "Norge"
se$variable <- "Sverige"
df <- rbind(  dk, fi, no, se  )
df
df <- df %>% filter(  age.group == 0 )
df <- df %>% select( period, variable, rs1yr, rs5yr, sex, entity  )
df$rs1yr <-  as.numeric(  as.character(  df$rs1yr ))
df$rs5yr <-  as.numeric(  as.character(  df$rs5yr ))
df
df$period[   df$period=="2000"] <- "2000-2004"
df$period[   df$period=="2005"] <- "2005-2009"
df$period[   df$period=="2010"] <- "2010-2014"
df$period
# hvad er stigningen i forhold til nÃ¦ste Ã¥r?
df$stigning_rs1yr <-   lead( df$rs1yr, 1)
df$stigning_rs5yr <-   lead( df$rs5yr, 1)
df$stigning_rs1yr[  df$period=="2010-2014"] <- NA
df$stigning_rs5yr[  df$period=="2010-2014"] <- NA
df <- df %>% filter( period %in% c("2000-2004", "2005-2009" )) # den sidste periode er 2009-2013, men den findes i kolonnen stigning, sÃ¥ den
df
